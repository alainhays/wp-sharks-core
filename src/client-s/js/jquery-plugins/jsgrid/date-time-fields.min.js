(function(e){var c=rgvfbtgzxqrdbpcdjvzpcrfrsbtgpdvpMomentData;var b=bvtnafpwxwhxtzqwqumtmwfywfmmgffdPickadateData;if(typeof c.i18n[c.locale]==="object"){moment.updateLocale(c.locale,c.i18n[c.locale])}var d={};var a=false;jsGridDateTimeFields=function(f){jsGrid.Field.call(this,f)};jsGridDateTimeFields.prototype=new jsGrid.Field({subType:"date-time",datePickerOptions:{},timePickerOptions:{},emptyDateTimeItemText:"—",emptyDateItemText:"—",emptyTimeItemText:"—",datePlaceholderText:"date",timePlaceholderText:"time",noTimeEquals:"startOfDay",_datePickerOptions:null,_timePickerOptions:null,_$dateEditInput:null,_$dateInsertInput:null,_$timeEditInput:null,_$timeInsertInput:null,editValue:function(){return this._actionTimestamp("edit",this.subType)},editTemplate:function(g,f){return this._actionTemplate("edit",this.subType,g)},insertValue:function(){return this._actionTimestamp("insert",this.subType)},insertTemplate:function(){return this._actionTemplate("insert",this.subType)},itemTemplate:function(g,f){return this._timestampFormat(g,this.subType,true)},sorter:function(g,f){return g-f},_pickerFunctionName:function(f){return"picka"+f},_pickerOptions:function(f){if(!this["_"+f+"PickerOptions"]){this["_"+f+"PickerOptions"]=e.extend({},b["default"+this._ucf(f)+"Options"],this[f+"PickerOptions"]);this["_"+f+"PickerOptions"].container=this._grid._container.parent();this["_"+f+"PickerOptions"].onClose=function(){e(document.activeElement).blur()}}return this["_"+f+"PickerOptions"]},_maybeKillStalePickers:function(){if(a){return}a=true;for(var f in d){if(!e.contains(this._grid._container[0],d[f].$node[0])){console.log("Killing stale picker: "+f);d[f].stop();delete d[f]}}a=false;console.log(d)},_actionTimestamp:function(g,i){if(i==="date-time"){var f=e.trim(this["_$date"+this._ucf(g)+"Input"].val());var h=e.trim(this["_$time"+this._ucf(g)+"Input"].val());f=f==="0"?"":f;h=h==="0"?"":h;if(f&&!h&&this.noTimeEquals==="startOfDay"){h=moment.utc().startOf("day").format(this._pickerOptions("time").momentFormat)}else{if(f&&!h&&this.noTimeEquals==="endOfDay"){h=moment.utc().endOf("day").format(this._pickerOptions("time").momentFormat)}}if(f&&h){return this._formatToTimestamp(f+" "+h,i)}else{if(f){return this._formatToTimestamp(f,"date")}else{if(h){return this._formatToTimestamp(h,"time")}}}return 0}else{return this._formatToTimestamp(this["_$"+i+this._ucf(g)+"Input"].val(),i)}},_actionTemplate:function(h,i,g){if(h==="insert"&&!this.inserting){return null}else{if(h==="edit"&&!this.editing){return this.itemTemplate(g)}}if(i==="date-time"){this["_$date"+this._ucf(h)+"Input"]=e('<input placeholder="'+_.escape(this.datePlaceholderText)+'" value="'+_.escape(h==="edit"&&g?this._timestampFormat(g,"date"):"")+'" />');this["_$time"+this._ucf(h)+"Input"]=e('<input placeholder="'+_.escape(this.timePlaceholderText)+'" value="'+_.escape(h==="edit"&&g?this._timestampFormat(g,"time"):"")+'" />');var f=e('<table style="box-sizing:border-box; width:100%; border:0; padding:0; margin:0;"> <tbody>   <tr style="border:0; padding:0; margin:0;">     <td class="-date" style="box-sizing:border-box; width:65%; border:0; padding:0; margin:0;"></td>     <td class="-time" style="box-sizing:border-box; width:35%; border:0; padding:0; margin:0;"></td>   </tr> </tbody></table>');f.find(".-date").append(this["_$date"+this._ucf(h)+"Input"]);f.find(".-time").append(this["_$time"+this._ucf(h)+"Input"]);this._maybeKillStalePickers();setTimeout(function(){this["_$date"+this._ucf(h)+"Input"][this._pickerFunctionName("date")](this._pickerOptions("date"));var k=this["_$date"+this._ucf(h)+"Input"][this._pickerFunctionName("date")]("picker");this["_$time"+this._ucf(h)+"Input"][this._pickerFunctionName("time")](this._pickerOptions("time"));var j=this["_$time"+this._ucf(h)+"Input"][this._pickerFunctionName("time")]("picker");d[k.$node[0].id]=k;d[j.$node[0].id]=j}.bind(this),100);return f}else{this["_$"+i+this._ucf(h)+"Input"]=e('<input placeholder="'+_.escape(this[i+"PlaceholderText"])+'" value="'+_.escape(h==="edit"&&g?this._timestampFormat(g,i):"")+'" />');this._maybeKillStalePickers();setTimeout(function(){this["_$"+i+this._ucf(h)+"Input"][this._pickerFunctionName(i)](this._pickerOptions(i));var j=this["_$"+i+this._ucf(h)+"Input"][this._pickerFunctionName(i)]("picker");d[j.$node[0].id]=j}.bind(this),100);return this["_$"+i+this._ucf(h)+"Input"]}},_timestampFormat:function(h,i,f){var g="";if(!(h=parseInt(h))){if(f&&i==="date-time"){g=this.emptyDateTimeItemText}else{if(f){g=this["empty"+this._ucf(i)+"ItemText"]}else{g=""}}}else{if(i==="date-time"){g=moment.utc(h,"X",c.locale).format(this._pickerOptions("date").momentFormat+" "+this._pickerOptions("time").momentFormat)+(f?" "+c.i18n.utc:"")}else{g=moment.utc(h,"X",c.locale).format(this._pickerOptions(i).momentFormat)+(f?" "+c.i18n.utc:"")}}return f?_.escape(g):g},_formatToTimestamp:function(g,h){var f=0;if(!(g=e.trim(g))||g==="0"){f=0}else{if(h==="date-time"){f=parseInt(moment.utc(g,this._pickerOptions("date").momentFormat+" "+this._pickerOptions("time").momentFormat,c.locale).format("X"))}else{f=parseInt(moment.utc(g,this._pickerOptions(h).momentFormat,c.locale).format("X"))}}return f},_currentInputTableRow:function(){var g=this._$dateEditInput||this._$dateInsertInput||this._$timeEditInput||this._$timeInsertInput||null;var f=g?g.closest(".jsgrid-edit-row, .jsgrid-insert-row"):null;if(f&&f.length===1){return f}else{return null}},_ucf:function(f){return f.charAt(0).toUpperCase()+f.slice(1).toLowerCase()}});jsGrid.fields.dateTime=jsGridDateTimeFields})(jQuery);